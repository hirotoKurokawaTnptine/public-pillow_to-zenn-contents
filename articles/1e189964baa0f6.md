---
title: "「1..10」から始める Powershell パイプライン 「|」ってなんだよ"
emoji: "⚙️"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: 
  -  "powershell"
  -  "初心者"
  -  "パイプライン"
published: false
---

## はじめに
初投稿です。
さっそく本題ですが、Powewrshell を触っていく内に以下のようなコードと遭遇することがあると思います。

```Powershell
Get-Process | Where-Object { $_.CPU -gt 100 }
```

えっ何これは、、、😅

- コマンドとコマンドの間に挟まる謎の「｜(ASCII 124) 」
- 定義してもないのに突然出てくる「$_」変数

「お前は誰だよ」と言いたくなりますが、ま、ま、そう、焦んないで。

この記事では **コマンドや関数の話はいったん脇に置いて、**
配列のような **生の値** から Powershell のパイプラインを理解していきますよ🫵

---

### パイプラインは「値が流れる道」
まずは、以下のような簡単な配列を用意します。
```Powershell
1..10
```
これは **範囲演算子** といって、1から10までの整数配列を生成しています。

では、パイプラインをつなげてみましょう。
```Powershell
1..10 | ForEach-Object { $_ }
```
なにも変わんねぇじゃん…
少し、動きを見えやすくします。

```Powershell
1..10 | ForEach-Object {
    Write-Host "$_ が流れている"
}
```

実行結果を再度見てみると…
- 1が流れている
- 2が流れている
- 3が流れている
- …
というように、変数「$_」に**値が1個ずつ流れている**ことが分かります。

---
### パイプラインは`foreach`と同じ発想
"ForEach"-Objectという名前の通り、上記の処理はforeach文でも書けます。
```Powershell
foreach ($n in 1..10) {
    Write-Host "$n が流れている"
}
```

